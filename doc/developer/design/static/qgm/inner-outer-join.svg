<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1524" height="977pt" viewBox="0 0 1143 977"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 973)"><title>G</title><polygon fill="#fff" stroke="transparent" points="-4 4 -4 -973 1139 -973 1139 4 -4 4"/><text x="329" y="-7.8" font-family="Times,serif" font-size="14" text-anchor="middle">select * from t1 left join t2 on t1.f1 = t2.f1 inner join t3 on t1.f1 = t3.f1; (before rewrites)</text><g id="clust1" class="cluster"><title>cluster0</title><polygon fill="none" stroke="#000" points="873 -691 873 -961 1127 -961 1127 -691 873 -691"/><text x="923.5" y="-945.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box0:Select</text></g><g id="clust3" class="cluster"><title>cluster1</title><polygon fill="none" stroke="#000" points="472 -402 472 -672 999 -672 999 -402 472 -402"/><text x="522.5" y="-656.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box1:Select</text></g><g id="clust5" class="cluster"><title>cluster5</title><polygon fill="none" stroke="#000" points="681 -216.5 681 -348.5 843 -348.5 843 -216.5 681 -216.5"/><text x="757" y="-333.3" font-family="Times,serif" font-size="14" text-anchor="middle">Box5:BaseTable T3</text></g><g id="clust7" class="cluster"><title>cluster2</title><polygon fill="none" stroke="#000" points="16 -182 16 -383 598 -383 598 -182 16 -182"/><text x="78.5" y="-367.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box2:OuterJoin</text></g><g id="clust9" class="cluster"><title>cluster4</title><polygon fill="none" stroke="#000" points="280 -31 280 -163 442 -163 442 -31 280 -31"/><text x="356" y="-147.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box4:BaseTable T2</text></g><g id="clust11" class="cluster"><title>cluster3</title><polygon fill="none" stroke="#000" points="8 -31 8 -163 170 -163 170 -31 8 -31"/><text x="84" y="-147.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box3:BaseTable T1</text></g><g id="node1" class="node"><title>boxhead0</title><polygon fill="none" stroke="#000" points="973 -699.5 973 -929.5 1119 -929.5 1119 -699.5 973 -699.5"/><text x="1046" y="-914.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="973 -906.5 1119 -906.5"/><text x="1046" y="-891.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q4.c0 as F1</text><polyline fill="none" stroke="#000" points="973 -883.5 1119 -883.5"/><text x="1046" y="-868.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q4.c1 as F2</text><polyline fill="none" stroke="#000" points="973 -860.5 1119 -860.5"/><text x="1046" y="-845.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q4.c2 as F2</text><polyline fill="none" stroke="#000" points="973 -837.5 1119 -837.5"/><text x="1046" y="-822.3" font-family="Times,serif" font-size="14" text-anchor="middle">3: Q4.c3 as F1</text><polyline fill="none" stroke="#000" points="973 -814.5 1119 -814.5"/><text x="1046" y="-799.3" font-family="Times,serif" font-size="14" text-anchor="middle">4: Q4.c4 as F2</text><polyline fill="none" stroke="#000" points="973 -791.5 1119 -791.5"/><text x="1046" y="-776.3" font-family="Times,serif" font-size="14" text-anchor="middle">5: Q4.c5 as F2</text><polyline fill="none" stroke="#000" points="973 -768.5 1119 -768.5"/><text x="1046" y="-753.3" font-family="Times,serif" font-size="14" text-anchor="middle">6: Q4.c6 as F1</text><polyline fill="none" stroke="#000" points="973 -745.5 1119 -745.5"/><text x="1046" y="-730.3" font-family="Times,serif" font-size="14" text-anchor="middle">7: Q4.c7 as F2</text><polyline fill="none" stroke="#000" points="973 -722.5 1119 -722.5"/><text x="1046" y="-707.3" font-family="Times,serif" font-size="14" text-anchor="middle">8: Q4.c8 as F2</text></g><g id="node2" class="node"><title>Q4</title><ellipse cx="918" cy="-814.5" fill="none" stroke="#000" rx="37.09" ry="37.09"/><text x="918" y="-810.8" font-family="Times,serif" font-size="14" text-anchor="middle">Q4(F)</text></g><g id="node3" class="node"><title>boxhead1</title><polygon fill="none" stroke="#000" points="845 -410.5 845 -640.5 991 -640.5 991 -410.5 845 -410.5"/><text x="918" y="-625.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="845 -617.5 991 -617.5"/><text x="918" y="-602.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q2.c0 as F1</text><polyline fill="none" stroke="#000" points="845 -594.5 991 -594.5"/><text x="918" y="-579.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q2.c1 as F2</text><polyline fill="none" stroke="#000" points="845 -571.5 991 -571.5"/><text x="918" y="-556.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q2.c2 as F2</text><polyline fill="none" stroke="#000" points="845 -548.5 991 -548.5"/><text x="918" y="-533.3" font-family="Times,serif" font-size="14" text-anchor="middle">3: Q2.c3 as F1</text><polyline fill="none" stroke="#000" points="845 -525.5 991 -525.5"/><text x="918" y="-510.3" font-family="Times,serif" font-size="14" text-anchor="middle">4: Q2.c4 as F2</text><polyline fill="none" stroke="#000" points="845 -502.5 991 -502.5"/><text x="918" y="-487.3" font-family="Times,serif" font-size="14" text-anchor="middle">5: Q2.c5 as F2</text><polyline fill="none" stroke="#000" points="845 -479.5 991 -479.5"/><text x="918" y="-464.3" font-family="Times,serif" font-size="14" text-anchor="middle">6: Q3.c0 as F1</text><polyline fill="none" stroke="#000" points="845 -456.5 991 -456.5"/><text x="918" y="-441.3" font-family="Times,serif" font-size="14" text-anchor="middle">7: Q3.c1 as F2</text><polyline fill="none" stroke="#000" points="845 -433.5 991 -433.5"/><text x="918" y="-418.3" font-family="Times,serif" font-size="14" text-anchor="middle">8: Q3.c2 as F2</text></g><g id="edge3" class="edge"><title>Q4-&gt;boxhead1</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M918,-777.44C918,-750.34 918,-711.27 918,-672"/></g><g id="node4" class="node"><title>Q2</title><ellipse cx="517" cy="-525.5" fill="none" stroke="#000" rx="37.09" ry="37.09"/><text x="517" y="-521.8" font-family="Times,serif" font-size="14" text-anchor="middle">Q2(F)</text></g><g id="node5" class="node"><title>Q3</title><ellipse cx="762" cy="-525.5" fill="none" stroke="#000" rx="64.99" ry="64.99"/><text x="762" y="-521.8" font-family="Times,serif" font-size="14" text-anchor="middle">Q3(F) as T3</text></g><g id="edge1" class="edge"><title>Q2-&gt;Q3</title><path fill="none" stroke="#000" d="M554.21,-525.5C591.96,-525.5 651.16,-525.5 696.73,-525.5"/><text x="625.53" y="-532.3" font-family="Times,serif" font-size="14" text-anchor="middle">(Q2.c0) = (Q3.c0)</text></g><g id="node7" class="node"><title>boxhead2</title><polygon fill="none" stroke="#000" points="444 -190.5 444 -351.5 590 -351.5 590 -190.5 444 -190.5"/><text x="517" y="-336.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="444 -328.5 590 -328.5"/><text x="517" y="-313.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q0.c0 as F1</text><polyline fill="none" stroke="#000" points="444 -305.5 590 -305.5"/><text x="517" y="-290.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q0.c1 as F2</text><polyline fill="none" stroke="#000" points="444 -282.5 590 -282.5"/><text x="517" y="-267.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q0.c2 as F2</text><polyline fill="none" stroke="#000" points="444 -259.5 590 -259.5"/><text x="517" y="-244.3" font-family="Times,serif" font-size="14" text-anchor="middle">3: Q1.c0 as F1</text><polyline fill="none" stroke="#000" points="444 -236.5 590 -236.5"/><text x="517" y="-221.3" font-family="Times,serif" font-size="14" text-anchor="middle">4: Q1.c1 as F2</text><polyline fill="none" stroke="#000" points="444 -213.5 590 -213.5"/><text x="517" y="-198.3" font-family="Times,serif" font-size="14" text-anchor="middle">5: Q1.c2 as F2</text></g><g id="edge4" class="edge"><title>Q2-&gt;boxhead2</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M517,-488.32C517,-460.63 517,-420.89 517,-383"/></g><g id="node6" class="node"><title>boxhead5</title><polygon fill="none" stroke="#000" points="689 -225 689 -317 835 -317 835 -225 689 -225"/><text x="762" y="-301.8" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="689 -294 835 -294"/><text x="762" y="-278.8" font-family="Times,serif" font-size="14" text-anchor="middle">0: c0 as F1</text><polyline fill="none" stroke="#000" points="689 -271 835 -271"/><text x="762" y="-255.8" font-family="Times,serif" font-size="14" text-anchor="middle">1: c1 as F2</text><polyline fill="none" stroke="#000" points="689 -248 835 -248"/><text x="762" y="-232.8" font-family="Times,serif" font-size="14" text-anchor="middle">2: c2 as F2</text></g><g id="edge5" class="edge"><title>Q3-&gt;boxhead5</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M762,-460.46C762,-426.39 762,-384.27 762,-348.5"/></g><g id="node8" class="node"><title>Q0</title><ellipse cx="89" cy="-271" fill="none" stroke="#000" rx="64.99" ry="64.99"/><text x="89" y="-267.3" font-family="Times,serif" font-size="14" text-anchor="middle">Q0(P) as T1</text></g><g id="node9" class="node"><title>Q1</title><ellipse cx="361" cy="-271" fill="none" stroke="#000" rx="64.99" ry="64.99"/><text x="361" y="-267.3" font-family="Times,serif" font-size="14" text-anchor="middle">Q1(F) as T2</text></g><g id="edge2" class="edge"><title>Q0-&gt;Q1</title><path fill="none" stroke="#000" d="M154.15,-271C197.06,-271 253.02,-271 295.91,-271"/><text x="225" y="-277.8" font-family="Times,serif" font-size="14" text-anchor="middle">(Q0.c0) = (Q1.c0)</text></g><g id="node11" class="node"><title>boxhead3</title><polygon fill="none" stroke="#000" points="16 -39.5 16 -131.5 162 -131.5 162 -39.5 16 -39.5"/><text x="89" y="-116.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="16 -108.5 162 -108.5"/><text x="89" y="-93.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: c0 as F1</text><polyline fill="none" stroke="#000" points="16 -85.5 162 -85.5"/><text x="89" y="-70.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: c1 as F2</text><polyline fill="none" stroke="#000" points="16 -62.5 162 -62.5"/><text x="89" y="-47.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: c2 as F2</text></g><g id="edge6" class="edge"><title>Q0-&gt;boxhead3</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M89,-205.82C89,-191.99 89,-177.24 89,-163"/></g><g id="node10" class="node"><title>boxhead4</title><polygon fill="none" stroke="#000" points="288 -39.5 288 -131.5 434 -131.5 434 -39.5 288 -39.5"/><text x="361" y="-116.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="288 -108.5 434 -108.5"/><text x="361" y="-93.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: c0 as F1</text><polyline fill="none" stroke="#000" points="288 -85.5 434 -85.5"/><text x="361" y="-70.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: c1 as F2</text><polyline fill="none" stroke="#000" points="288 -62.5 434 -62.5"/><text x="361" y="-47.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: c2 as F2</text></g><g id="edge7" class="edge"><title>Q1-&gt;boxhead4</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M361,-205.82C361,-191.99 361,-177.24 361,-163"/></g></g></svg>