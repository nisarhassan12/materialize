<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="875pt" height="848" viewBox="0 0 875 635.99"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 631.99)"><title>G</title><polygon fill="#fff" stroke="transparent" points="-4 4 -4 -631.99 871 -631.99 871 4 -4 4"/><text x="208.5" y="-7.8" font-family="Times,serif" font-size="14" text-anchor="middle">select * from t1 union select * from t2; (before rewrites)</text><g id="clust1" class="cluster"><title>cluster0</title><polygon fill="none" stroke="#000" points="605 -487.99 605 -619.99 859 -619.99 859 -487.99 605 -487.99"/><text x="655.5" y="-604.79" font-family="Times,serif" font-size="14" text-anchor="middle">Box0:Select</text></g><g id="clust3" class="cluster"><title>cluster5</title><polygon fill="none" stroke="#000" points="313 -347.99 313 -479.99 802 -479.99 802 -347.99 313 -347.99"/><text x="363" y="-464.79" font-family="Times,serif" font-size="14" text-anchor="middle">Box5:Union</text></g><g id="clust5" class="cluster"><title>cluster3</title><polygon fill="none" stroke="#000" points="334 -171 334 -339.99 644 -339.99 644 -171 334 -171"/><text x="384.5" y="-324.79" font-family="Times,serif" font-size="14" text-anchor="middle">Box3:Select</text></g><g id="clust7" class="cluster"><title>cluster4</title><polygon fill="none" stroke="#000" points="326 -31 326 -163 488 -163 488 -31 326 -31"/><text x="402" y="-147.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box4:BaseTable T2</text></g><g id="clust9" class="cluster"><title>cluster1</title><polygon fill="none" stroke="#000" points="16 -171 16 -339.99 326 -339.99 326 -171 16 -171"/><text x="66.5" y="-324.79" font-family="Times,serif" font-size="14" text-anchor="middle">Box1:Select</text></g><g id="clust11" class="cluster"><title>cluster2</title><polygon fill="none" stroke="#000" points="8 -31 8 -163 170 -163 170 -31 8 -31"/><text x="84" y="-147.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box2:BaseTable T1</text></g><g id="node1" class="node"><title>boxhead0</title><polygon fill="none" stroke="#000" points="705 -496.49 705 -588.49 851 -588.49 851 -496.49 705 -496.49"/><text x="778" y="-573.29" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="705 -565.49 851 -565.49"/><text x="778" y="-550.29" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q4.c0 as F1</text><polyline fill="none" stroke="#000" points="705 -542.49 851 -542.49"/><text x="778" y="-527.29" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q4.c1 as F2</text><polyline fill="none" stroke="#000" points="705 -519.49 851 -519.49"/><text x="778" y="-504.29" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q4.c2 as F3</text></g><g id="node2" class="node"><title>Q4</title><ellipse cx="650" cy="-542.49" fill="none" stroke="#000" rx="37.09" ry="37.09"/><text x="650" y="-538.79" font-family="Times,serif" font-size="14" text-anchor="middle">Q4(F)</text></g><g id="node3" class="node"><title>boxhead5</title><polygon fill="none" stroke="#000" points="505.5 -356.49 505.5 -448.49 794.5 -448.49 794.5 -356.49 505.5 -356.49"/><text x="650" y="-433.29" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Enforce</text><polyline fill="none" stroke="#000" points="505.5 -425.49 794.5 -425.49"/><text x="650" y="-410.29" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q2.c0 as F1</text><polyline fill="none" stroke="#000" points="505.5 -402.49 794.5 -402.49"/><text x="650" y="-387.29" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q2.c1 as F2</text><polyline fill="none" stroke="#000" points="505.5 -379.49 794.5 -379.49"/><text x="650" y="-364.29" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q2.c2 as F3</text></g><g id="edge1" class="edge"><title>Q4-&gt;boxhead5</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M650,-505.23C650,-497.36 650,-488.76 650,-479.99"/></g><g id="node4" class="node"><title>Q2</title><ellipse cx="358" cy="-402.49" fill="none" stroke="#000" rx="37.09" ry="37.09"/><text x="358" y="-398.79" font-family="Times,serif" font-size="14" text-anchor="middle">Q2(F)</text></g><g id="node9" class="node"><title>boxhead1</title><polygon fill="none" stroke="#000" points="172 -197.99 172 -289.99 318 -289.99 318 -197.99 172 -197.99"/><text x="245" y="-274.79" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="172 -266.99 318 -266.99"/><text x="245" y="-251.79" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q0.c0 as F1</text><polyline fill="none" stroke="#000" points="172 -243.99 318 -243.99"/><text x="245" y="-228.79" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q0.c1 as F2</text><polyline fill="none" stroke="#000" points="172 -220.99 318 -220.99"/><text x="245" y="-205.79" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q0.c2 as F3</text></g><g id="edge2" class="edge"><title>Q2-&gt;boxhead1</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M336.75,-372.05C329.91,-362.59 321.94,-351.55 313.59,-339.99"/></g><g id="node5" class="node"><title>Q3</title><ellipse cx="450" cy="-402.49" fill="none" stroke="#000" rx="37.09" ry="37.09"/><text x="450" y="-398.79" font-family="Times,serif" font-size="14" text-anchor="middle">Q3(F)</text></g><g id="node6" class="node"><title>boxhead3</title><polygon fill="none" stroke="#000" points="490 -197.99 490 -289.99 636 -289.99 636 -197.99 490 -197.99"/><text x="563" y="-274.79" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="490 -266.99 636 -266.99"/><text x="563" y="-251.79" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q1.c0 as F1</text><polyline fill="none" stroke="#000" points="490 -243.99 636 -243.99"/><text x="563" y="-228.79" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q1.c1 as F2</text><polyline fill="none" stroke="#000" points="490 -220.99 636 -220.99"/><text x="563" y="-205.79" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q1.c2 as F3</text></g><g id="edge3" class="edge"><title>Q3-&gt;boxhead3</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M471.25,-372.05C478.09,-362.59 486.06,-351.55 494.41,-339.99"/></g><g id="node7" class="node"><title>Q1</title><ellipse cx="407" cy="-243.99" fill="none" stroke="#000" rx="64.99" ry="64.99"/><text x="407" y="-240.29" font-family="Times,serif" font-size="14" text-anchor="middle">Q1(F) as T2</text></g><g id="node8" class="node"><title>boxhead4</title><polygon fill="none" stroke="#000" points="334 -39.5 334 -131.5 480 -131.5 480 -39.5 334 -39.5"/><text x="407" y="-116.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="334 -108.5 480 -108.5"/><text x="407" y="-93.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: c0 as F1</text><polyline fill="none" stroke="#000" points="334 -85.5 480 -85.5"/><text x="407" y="-70.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: c1 as F2</text><polyline fill="none" stroke="#000" points="334 -62.5 480 -62.5"/><text x="407" y="-47.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: c2 as F3</text></g><g id="edge4" class="edge"><title>Q1-&gt;boxhead4</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M407,-178.89C407,-173.65 407,-168.32 407,-163"/></g><g id="node10" class="node"><title>Q0</title><ellipse cx="89" cy="-243.99" fill="none" stroke="#000" rx="64.99" ry="64.99"/><text x="89" y="-240.29" font-family="Times,serif" font-size="14" text-anchor="middle">Q0(F) as T1</text></g><g id="node11" class="node"><title>boxhead2</title><polygon fill="none" stroke="#000" points="16 -39.5 16 -131.5 162 -131.5 162 -39.5 16 -39.5"/><text x="89" y="-116.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="16 -108.5 162 -108.5"/><text x="89" y="-93.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: c0 as F1</text><polyline fill="none" stroke="#000" points="16 -85.5 162 -85.5"/><text x="89" y="-70.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: c1 as F2</text><polyline fill="none" stroke="#000" points="16 -62.5 162 -62.5"/><text x="89" y="-47.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: c2 as F3</text></g><g id="edge5" class="edge"><title>Q0-&gt;boxhead2</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M89,-178.89C89,-173.65 89,-168.32 89,-163"/></g></g></svg>