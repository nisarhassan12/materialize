<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="844pt" height="871pt" viewBox="0 0 844 870.98"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 866.98)"><title>G</title><polygon fill="#fff" stroke="transparent" points="-4 4 -4 -866.98 840 -866.98 840 4 -4 4"/><text x="418" y="-7.8" font-family="Times,serif" font-size="14" text-anchor="middle">select * from t1, lateral(select f1 from t2 where t2.f2 = t1.f3 group by f1) as l where t1.f1 = l.f1; (before rewrites)</text><g id="clust1" class="cluster"><title>cluster0</title><polygon fill="none" stroke="#000" points="217.5 -685.99 217.5 -854.98 788.5 -854.98 788.5 -685.99 217.5 -685.99"/><text x="268" y="-839.78" font-family="Times,serif" font-size="14" text-anchor="middle">Box0:Select</text></g><g id="clust3" class="cluster"><title>cluster5</title><polygon fill="none" stroke="#000" points="380.5 -544.44 380.5 -657.54 786.5 -657.54 786.5 -544.44 380.5 -544.44"/><text x="431" y="-642.34" font-family="Times,serif" font-size="14" text-anchor="middle">Box5:Select</text></g><g id="clust5" class="cluster"><title>cluster4</title><polygon fill="none" stroke="#000" points="216.5 -369.99 216.5 -501.99 622.5 -501.99 622.5 -369.99 216.5 -369.99"/><text x="278.5" y="-486.79" font-family="Times,serif" font-size="14" text-anchor="middle">Box4:Grouping</text></g><g id="clust7" class="cluster"><title>cluster2</title><polygon fill="none" stroke="#000" points="55.5 -182 55.5 -350.99 365.5 -350.99 365.5 -182 55.5 -182"/><text x="106" y="-335.79" font-family="Times,serif" font-size="14" text-anchor="middle">Box2:Select</text></g><g id="clust9" class="cluster"><title>cluster3</title><polygon fill="none" stroke="#000" points="47.5 -31 47.5 -163 209.5 -163 209.5 -31 47.5 -31"/><text x="123.5" y="-147.8" font-family="Times,serif" font-size="14" text-anchor="middle">Box3:BaseTable T2</text></g><g id="clust11" class="cluster"><title>cluster1</title><polygon fill="none" stroke="#000" points="209.5 -534.99 209.5 -666.99 371.5 -666.99 371.5 -534.99 209.5 -534.99"/><text x="285.5" y="-651.79" font-family="Times,serif" font-size="14" text-anchor="middle">Box1:BaseTable T1</text></g><g id="node1" class="node"><title>boxhead0</title><polygon fill="none" stroke="#000" points="634.5 -701.48 634.5 -816.48 780.5 -816.48 780.5 -701.48 634.5 -701.48"/><text x="707.5" y="-801.28" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="634.5 -793.48 780.5 -793.48"/><text x="707.5" y="-778.28" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q0.c0 as F1</text><polyline fill="none" stroke="#000" points="634.5 -770.48 780.5 -770.48"/><text x="707.5" y="-755.28" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q0.c1 as F2</text><polyline fill="none" stroke="#000" points="634.5 -747.48 780.5 -747.48"/><text x="707.5" y="-732.28" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q0.c2 as F3</text><polyline fill="none" stroke="#000" points="634.5 -724.48 780.5 -724.48"/><text x="707.5" y="-709.28" font-family="Times,serif" font-size="14" text-anchor="middle">3: Q4.c0 as F1</text></g><g id="node2" class="node"><title>Q0</title><ellipse cx="290.5" cy="-758.98" fill="none" stroke="#000" rx="64.99" ry="64.99"/><text x="290.5" y="-755.28" font-family="Times,serif" font-size="14" text-anchor="middle">Q0(F) as T1</text></g><g id="node3" class="node"><title>Q4</title><ellipse cx="557.5" cy="-758.98" fill="none" stroke="#000" rx="59.29" ry="59.29"/><text x="557.5" y="-755.28" font-family="Times,serif" font-size="14" text-anchor="middle">Q4(F) as L</text></g><g id="edge1" class="edge"><title>Q0-&gt;Q4</title><path fill="none" stroke="#000" d="M355.82,-758.98C399.35,-758.98 456.11,-758.98 498.32,-758.98"/><text x="426.92" y="-765.78" font-family="Times,serif" font-size="14" text-anchor="middle">(Q0.c0) = (Q4.c0)</text></g><g id="node9" class="node"><title>Q1</title><ellipse cx="128.5" cy="-254.99" fill="none" stroke="#000" rx="64.99" ry="64.99"/><text x="128.5" y="-251.29" font-family="Times,serif" font-size="14" text-anchor="middle">Q1(F) as T2</text></g><g id="edge2" class="edge"><title>Q0-&gt;Q1</title><path fill="none" stroke="#000" d="M241.6,-715.65C227.98,-701.48 214.48,-684.74 205.5,-666.99 148.32,-553.95 133.32,-404.05 129.56,-320.07"/><text x="219" y="-513.79" font-family="Times,serif" font-size="14" text-anchor="middle">(Q1.c1) = (Q0.c2)</text></g><g id="node11" class="node"><title>boxhead1</title><polygon fill="none" stroke="#000" points="217.5 -543.49 217.5 -635.49 363.5 -635.49 363.5 -543.49 217.5 -543.49"/><text x="290.5" y="-620.29" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="217.5 -612.49 363.5 -612.49"/><text x="290.5" y="-597.29" font-family="Times,serif" font-size="14" text-anchor="middle">0: c0 as F1</text><polyline fill="none" stroke="#000" points="217.5 -589.49 363.5 -589.49"/><text x="290.5" y="-574.29" font-family="Times,serif" font-size="14" text-anchor="middle">1: c1 as F2</text><polyline fill="none" stroke="#000" points="217.5 -566.49 363.5 -566.49"/><text x="290.5" y="-551.29" font-family="Times,serif" font-size="14" text-anchor="middle">2: c2 as F3</text></g><g id="edge3" class="edge"><title>Q0-&gt;boxhead1</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M290.5,-693.7C290.5,-684.96 290.5,-675.92 290.5,-666.99"/></g><g id="node4" class="node"><title>boxhead5</title><polygon fill="none" stroke="#000" points="481 -554.99 481 -623.99 778 -623.99 778 -554.99 481 -554.99"/><text x="629.5" y="-608.79" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="481 -600.99 778 -600.99"/><text x="629.5" y="-585.79" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q3.c0 as F1</text><polyline fill="none" stroke="#000" points="481 -577.99 778 -577.99"/><text x="629.5" y="-562.79" font-family="Times,serif" font-size="14" text-anchor="middle">UNIQUE KEY [0]</text></g><g id="edge4" class="edge"><title>Q4-&gt;boxhead5</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M580.68,-704.06C587.05,-689.25 594.03,-672.99 600.68,-657.53"/></g><g id="node5" class="node"><title>Q3</title><ellipse cx="425.5" cy="-589.49" fill="none" stroke="#000" rx="37.09" ry="37.09"/><text x="425.5" y="-585.79" font-family="Times,serif" font-size="14" text-anchor="middle">Q3(F)</text></g><g id="node6" class="node"><title>boxhead4</title><polygon fill="none" stroke="#000" points="317 -378.49 317 -470.49 614 -470.49 614 -378.49 317 -378.49"/><text x="465.5" y="-455.29" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="317 -447.49 614 -447.49"/><text x="465.5" y="-432.29" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q2.c0 as F1</text><polyline fill="none" stroke="#000" points="317 -424.49 614 -424.49"/><text x="465.5" y="-409.29" font-family="Times,serif" font-size="14" text-anchor="middle">GROUP Q2.c0 Ascending</text><polyline fill="none" stroke="#000" points="317 -401.49 614 -401.49"/><text x="465.5" y="-386.29" font-family="Times,serif" font-size="14" text-anchor="middle">UNIQUE KEY [0]</text></g><g id="edge5" class="edge"><title>Q3-&gt;boxhead4</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M434.18,-553.12C437.88,-538.06 442.34,-519.86 446.73,-501.98"/></g><g id="node7" class="node"><title>Q2</title><ellipse cx="261.5" cy="-424.49" fill="none" stroke="#000" rx="37.09" ry="37.09"/><text x="261.5" y="-420.79" font-family="Times,serif" font-size="14" text-anchor="middle">Q2(F)</text></g><g id="node8" class="node"><title>boxhead2</title><polygon fill="none" stroke="#000" points="211.5 -208.99 211.5 -300.99 357.5 -300.99 357.5 -208.99 211.5 -208.99"/><text x="284.5" y="-285.79" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="211.5 -277.99 357.5 -277.99"/><text x="284.5" y="-262.79" font-family="Times,serif" font-size="14" text-anchor="middle">0: Q1.c0 as F1</text><polyline fill="none" stroke="#000" points="211.5 -254.99 357.5 -254.99"/><text x="284.5" y="-239.79" font-family="Times,serif" font-size="14" text-anchor="middle">1: Q1.c1 as F2</text><polyline fill="none" stroke="#000" points="211.5 -231.99 357.5 -231.99"/><text x="284.5" y="-216.79" font-family="Times,serif" font-size="14" text-anchor="middle">2: Q1.c2 as F3</text></g><g id="edge6" class="edge"><title>Q2-&gt;boxhead2</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M266.43,-387.56C267.94,-376.59 269.67,-363.97 271.46,-350.98"/></g><g id="node10" class="node"><title>boxhead3</title><polygon fill="none" stroke="#000" points="55.5 -39.5 55.5 -131.5 201.5 -131.5 201.5 -39.5 55.5 -39.5"/><text x="128.5" y="-116.3" font-family="Times,serif" font-size="14" text-anchor="middle">Distinct: Preserve</text><polyline fill="none" stroke="#000" points="55.5 -108.5 201.5 -108.5"/><text x="128.5" y="-93.3" font-family="Times,serif" font-size="14" text-anchor="middle">0: c0 as F1</text><polyline fill="none" stroke="#000" points="55.5 -85.5 201.5 -85.5"/><text x="128.5" y="-70.3" font-family="Times,serif" font-size="14" text-anchor="middle">1: c1 as F2</text><polyline fill="none" stroke="#000" points="55.5 -62.5 201.5 -62.5"/><text x="128.5" y="-47.3" font-family="Times,serif" font-size="14" text-anchor="middle">2: c2 as F3</text></g><g id="edge7" class="edge"><title>Q1-&gt;boxhead3</title><path fill="none" stroke="#000" stroke-dasharray="5 2" d="M128.5,-189.72C128.5,-180.97 128.5,-171.93 128.5,-163"/></g></g></svg>